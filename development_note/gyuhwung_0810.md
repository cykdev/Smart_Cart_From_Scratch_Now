먼저 고양이 사진 과 바코드 사진을 분류하는 간단한 CNN 모델을 만들었다.

(샘플 바코드 이미지와 고양이 이미지는 구글 클라우드에 추후에 업로드 할 예정이다. 오늘은 회사 GPU 컴퓨터를 사용중이라 업로드가 안된다..)

이는 어떤 이미지 전처리가 고양이/바코드 분류에 효과적인기 실험하기 위한 방법이다.

만약 특정 이미지 전처리 (예를 들어 sobel kernel)이후 CNN 학습시 정확도가 빠르게 상승한다면 

해당 전처리가 바코드를 찾는데 유의미할것이라 생각했기 떄문이다.

케라스를 통해 작업을 했고 직접 만든 간단한 CNN 모델을 사용했다.

직접 구현한 간단한 CNN 모델 학습결과

Epoch 1/3
100/100 [==============================] - 55s 550ms/step - loss: 0.3088 - acc: 0.8469 - val_loss: 0.1013 - val_acc: 0.9480

Epoch 2/3
100/100 [==============================] - 50s 497ms/step - loss: 0.0869 - acc: 0.9725 - val_loss: 0.0762 - val_acc: 0.9617

Epoch 3/3
100/100 [==============================] - 49s 487ms/step - loss: 0.0721 - acc: 0.9725 - val_loss: 0.0180 - val_acc: 0.9924

이제 여러 이미지 전처리를 통해 학습속도가 높아지는지, 정확도가 높아지는지 확인하려고 한다.

그러나

이미지 인풋 사이즈를 128*128로 설정했을시엔 OOM (Out Of Memory) 문제가 없었지만 그 이상의 크기는 OOM 문제가 일어났다

i5-9060k, 1060-gtx, 16gb ram인데 이런 문제가 발생했다 

실제 바코드 감지에 이 모델을 사용하려면 512*512 정도는 되는 크기의 이미지를 소화할수 있어야 할 것 같기에 이 문제를 해결해야한다.

그리고 이미지 크기가 커질수록 CNN 모델서 학습시킬 파라메터수가 급격하게 늘어났다. 

만약 딥러닝을 사용한다면 최적의 이미지 크기 (카트내에서 물체를 인식하기에 최적합한) 를 찾아내는 것이 좋을 것같다.

이미지 전처리에 따른 학습속도/정확도 변화는 내일 할꺼다~ 넘 피곤쓰~

